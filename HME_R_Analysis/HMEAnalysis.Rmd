---
title: "HMEAnalysis"
author: "Jasmin E. Palmer"
date: "`r Sys.Date()`"
output: pdf_document
---

```{r setup, include=FALSE}

library("knitr")
library("tidyverse")
library("readxl")
library("PMCMRplus")
library("lattice")

```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:


### Load the data set 
```{r}
# load the data set here
completionTime <- read_excel("./HMEData-for-R/Completion Time.xlsx")
```



```{r}
### Order levels of the factor; otherwise R will alphabetize them
completionTime$SubjectNum = factor(completionTime$SubjectNum, levels = unique(completionTime$SubjectNum))
### Create a new variable which is the Mappings as an ordered factor
completionTime$Mappings = factor(completionTime$Mappings, levels = unique(completionTime$Mappings))


completionTime$SubjectData = as.numeric(completionTime$SubjectData)

###  Check the data frame
str(completionTime)

summary(completionTime)
```


### Summarize the data: Treating Subject Data as Factors
```{r}
XT = xtabs(~ SubjectNum + SubjectData, data = completionTime)

prop.table(XT, margin = 1)
```

### Make Bar Plots by Mapping
```{r}
histogram(~ SubjectData | SubjectNum,
          data = completionTime,
          #layout = c(0,30),
          col = "blue")

```

### Perform the Two-Way ANOVA Test
```{r}

head(completionTime)

# Perform a two-way ANOVA with interaction effects
form <- SubjectData ~ Mappings * SubjectNum
model <- aov(formula = form, data = completionTime)

# Print a summary of the ANOVA results
summary(model)

```

### Tukey's test
```{r} 
# table with factors, means and standard deviation
data_summary <- group_by(completionTime, Mappings, SubjectData) %>%
  summarise(mean=mean(SubjectData), sd=sd(SubjectData)) %>%
  arrange(desc(mean))


tukey <- TukeyHSD(model)
#print(tukey)
# creating the compact letter display
tukey.cld <- multcompLetters4(model, tukey)
print(tukey.cld)


# adding the compact letter display to the table with means and sd
cld <- as.data.frame.list(tukey.cld$`Mappings:SubjectNum`)
data_summary$Tukey <- cld$Letters
print(data_summary)
```


## Including Plots

You can also embed plots, for example:

```{r completionTime, echo=FALSE}
plot(completionTime)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
